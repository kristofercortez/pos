{% extends "GistTemplateBundle::base.html.twig" %}
{% import "GistTemplateBundle::form.html.twig" as form_tools %}
{% block content %}
<div class="page-content">
	<form method="post" class="form-horizontal">
		<div class="row" style="width: 100%;">
			<div class="col-md-1"></div>
			<div class="col-md-10">
				<h2 class="form-section">Reports</h2>
				<br>
				<!--BEGIN TABS-->
		            <div class="tabbable tabbable-custom tabbable-full-width">
		                <!-- MAIN TABS -->
		                <ul class="nav nav-tabs">
		                    <li class="active">
		                        <a href="#tab_sales_history" data-toggle="tab">
		                            Sales History </a>
		                    </li>
		                    <li>
		                        <a href="#tab_sync_settings" data-toggle="tab">
		                            Users</a>
		                    </li>
		                </ul>
		                <!-- END MAIN TABS -->
		                <div class="tab-content">
		                    <div class="tab-pane active" id="tab_sales_history">
		                        {% include 'GistPOSBundle:Reports:sales_history.html.twig' %}
		                    </div>
		                    <div class="tab-pane" id="tab_sync_settings">
		                        
		                    </div>
		                </div>
		            </div>
		            <!--END TABS-->
			</div>
			<div class="col-md-1"></div>
		</div>
	</form>
</div>
{% endblock %}
{% block js %}
<script>
function syncUsers()
{
    var route = "{{ path('gist_pos_settings_sync_users')|escape('js') }}";
    $.getJSON(route, function(json){  
       $.each(json, function(i, x) {
            swal({
              title: "Users Data Updated!",
              text: "The page will now reload",
              type: "success",
              confirmButtonColor: "green",
              confirmButtonText: "Okay",
            },
            function(){
            	location.reload();
                
            });

        });
    });
}

$(document).ready(function(){ 

	$('#list_table').dataTable({
        "bProcessing": true,
        "bServerSide": true,
        "sAjaxSource": "{{ path(route_grid) }}",
        "iDisplayLength": 10,
        "sPaginationType": "bootstrap",
        "oLanguage": {
            "sLengthMenu": "_MENU_ records",
            "oPaginate": {
                "sPrevious": "Prev",
                "sNext": "Next"
            }
        },
        "aoColumnDefs": [
            { "bSortable": false, "aTargets": [{{ grid_cols|length - 1}}] },
        ]
    });

    $('#list_table_wrapper .dataTables_filter input').addClass("form-control input-small input-inline"); // modify table search input
    $('#list_table_wrapper .dataTables_length select').addClass("form-control input-xsmall input-inline"); // modify table per page dropdown
    $('#list_table_wrapper .dataTables_length select').select2(); // initialize select2 dropdown

	$(document).on("click",".sync_users", function(e){
		swal({
          title: "Proceed with action?",
          text: "This will update all user records on this machine",	
          imageUrl: '{{ asset('bundles/gisttemplate/assets/global/img/warning.png') }}',
          imageSize: '100x100',
          showConfirmButton: true,
          showCancelButton: true
        },
        function(){
                // alert('hello');
                //location.reload();
            	syncUsers();
        });
		//update users here
		// syncUsers();
	});
    
});
</script>
{% endblock %}